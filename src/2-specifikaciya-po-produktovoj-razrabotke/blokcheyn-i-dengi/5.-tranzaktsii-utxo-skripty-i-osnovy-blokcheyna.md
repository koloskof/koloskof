# 5. Транзакции, UTXO и скрипт-код

Лекция 5 из курса MIT "Блокчейн и деньги", лектор Гари Генслер

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/ed56bb00-54b3-5714-a39a-f4b0067759bc/-/preview/592x/)

## План лекции

- Ввод и вывод транзакций
- Неизрасходованный вывод транзакций (UTXO)
- Язык сценариев
- Дизайн блокчейна - Сведение всего этого воедино
- Научная родословная биткойнов
- Кто такой Сатоши Накамото?
- Выводы

## Вопросы лекции

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/4031a2fc-0ebb-5a6c-8581-617b73759440/-/preview/592x/)

- Как Биткойн регистрирует транзакции? Что  
    такое вывод неизрасходованных транзакций (UTXO)? Что такое скриптовый код, встроенный в каждую транзакцию Биткойна, и насколько это гибкий язык программирования?
- Поскольку многие конструктивные особенности предшествовали Биткоину, в чем заключалось новшество Сатоши Накамото?
- Кто такой Сатоши Накамото?

## Материалы для чтения

- "Bitcoin's Academic Pedigree" Narayanan and Clark
- "Making Sense of Crypto economics" CoinDesk

## Формат транзакций

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/67d9c988-7508-58ce-9193-0edabdbb4e3e/-/preview/592x/)

Формат транзакции очень прост. Есть входные данные, цифровая подпись и получатель транзакции (адрес кошелька).

В биткоине есть вводные данные - хэшированный айди предыдущей транзакции. То есть вводные данные появляются на основе предыдущих выходных данных.

Откуда пришли все тразакции? Coinbase, верно. Это создание свежего биткоина.

Что такое время блокировки? Это механизм для установления временных условий выполнения транзакции.

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/4a3f4fd1-f860-555e-b7fe-7d5aeeb2365b/-/preview/592x/)

Входных и выходных данных может быть несколько.

Что происходит с входными данными после того, как происходит транзакция? Они стираются после совершения транзакции.

## Коинбейз транзакции

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/68f81afa-7bb7-5d89-9728-8ff39e8f0aab/-/preview/592x/)

Коинбейз транзакция - это награда майнеру за работу с Proof of work.

- Единственным вводимым значением является вознаграждение за блок Coinbase
- Вознаграждение делится пополам (1/2 секунды) каждые 210 000 блоков
- В настоящее время 12,5 биткоина за блок
- Первоначально 50 биткоинов за блок
- Выходные данные не могут использоваться в качестве входных данных транзакции до тех пор, пока не будет выполнено еще 100 блоков
- Записано как первая транзакция в дереве Меркла
- Может содержать 100 байт произвольных данных
- Используется для дополнительного одноразового использования
- В блок Genesis включен заголовок из Financial Times:  
    "The Times 03/Январь/2009 Канцлер на пороге второй финансовой помощи банкам"

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/84420ea6-cbf5-5df9-b0a5-14c6a8c17c8b/-/preview/592x/)

На этом слайде представлено количество неизрасходованных транзакций. На момент 2018 года это примерно 50-60 миллионов. Это число измеряется не в биткоинах.

Среди этих неизрасходованных транзакций есть те, что называют "пылью". К ним относятся те транзакции, за которые невыгодно даже платить комиссию. Поэтому очень возможно, что эти транзакции никогда не используют, просто потому что это экономически невыгодно. Это словно копейки, которые лежат где-то в ящике, а вы их не тратите.

Возможно ли такое, что эти транзакции могут когда-нибудь стать дороже и стать выгоднее? Да, могут, как и копейки однажды. Но, как и копейки, их нужно не потерять, пока вы ждете повышения цены.

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/a7452588-06a8-56f3-b45e-90aa664eba2e/-/preview/592x/)

На этом слайде обозначено общее количество транзакций, которые когда-либо вообще произошли на сети биткоина. На момент 2018 года это 342 транзакции.

Где хранятся эти неизрасходованные транзакции? Они хранятся в таблице UTXO, а также на десяти тысячах нодах в блокчейн.

## Набор выходных данных неизрасходованной транзакции (UTXO)

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/66a1639f-e002-5bbe-8853-94bf72338d11/-/preview/592x/)

UTXO - выходные данные транзакции Bitcoin, которые не были потрачены в данный момент времени.

- Содержит все текущие неизрасходованные выходные данные транзакции
- Ускоряет процесс проверки транзакции
- Хранится с использованием базы данных LevelDB в Bitcoin Core под названием "состояние цепочки"  
    

## Биткойн-скрипт

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/59785b9a-35f2-58fe-bd0b-39b639132256/-/preview/592x/)

Биткойн-скрипт - программный код, используемый для транзакции.

- Код на основе стека, без циклов (не полный по Тьюрингу)
- Предоставляет гибкий набор инструкций для проверки транзакции и  
    аутентификации подписи
- Наиболее распространенные типы скриптов в UTXO:  
    • Транзакция, отправленная на хэш биткоин-адреса - 'Pay-to-PubkeyHash'  
    (81%)  
    • Транзакция, отправленная на хэш условного скрипта - 'Pay-to-scriptHash' (18%)  
    • Транзакция, требующая нескольких подписей - "M из N мультисигналов" (0,7%)  
    • Транзакция, отправленная на биткоин-адрес - "Pay-to-Pubkey" (0,1%)  
    (Источник: Перес-Сола, Дельгадо-Сегура и др.)

## Биткоин - технические характеристики

![Транзакции, UTXO и скрипт-код](https://leonardo.osnova.io/d6c3042d-b006-504b-b6c4-ea489947d5ef/-/preview/592x/)

- Криптография и журналы с отметками времени  
    • Криптографические хэш-функции  
    • Криптографические хэш-функции  
    • Журналы (блоки) только для добавления временных меток  
    • Заголовки блоков и деревья Меркла  
    • Асимметричная криптография и цифровые подписи  
    • Адреса
- Консенсус децентрализованной сети  
    • Подтверждение работы  
    • Национальная валюта  
    • Сеть
- Сценарий транзакции и UTXO  
    • Входы и выходы транзакции  
    • Задан неизрасходованный вывод транзакции (UTXO)  
    • Язык сценариев